(function(){var c=document.getElementsByTagName("script");var b=c[c.length-1];var a=b.src;window.gThemePath=a.substr(0,a.lastIndexOf("/js/"))})();window.gEnableTocStatusUpdate=true;window.gEnableTocListAutoScroll=true;window.gMouseInSidebarTocList=false;window.gToolbarHidden=true;window.gFixedHeaderHeight=32;window.gFixedTocListOffsetTop=111;window.gFootnotePopoverMaxWidth=300;window.gActiveTocClass="niu2-active-toc";$(document).ready(function(){initGoogleCSEAnimation()});function onContentLoaded(){initPygments();initHermitPlayer();initLazyLoad();initFootnote();$(window).scroll(function(){toggleSidebarTocFixed();locateTocInViewport()});updateFootnoteStatus();getTocList().detach();initTocListIndex(getTocList());getTocList().appendTo(getSidebarToc());setSidebarTocSize();setTocOverflowedTitle();initTocLinkScrollAnimation();initAllTocsCtrl();locateTocInViewport();initToolbar()}function initPygments(){if($("pre")[0]){var a='<link rel="stylesheet" href="'+window.gThemePath+"/css/pygments.min/"+$("#niu2-pygments").data("theme")+'.min.css" type="text/css"/>';$(a).appendTo($("head"))}}function initHermitPlayer(){if($(".hermit")[0]){var a='<link href="'+window.gThemePath+'/hermit/assets/style/hermit.min.css" rel="stylesheet" type="text/css"/>';$(a).appendTo($("head"));hermit={url:window.gThemePath+"/hermit/assets/swf"};var b='<script src="'+window.gThemePath+'/hermit/assets/script/hermit.min.js" type="text/javascript"><\/script>';$(b).appendTo($("body"))}}function initToolbar(){if(getToolbar()){var b=$("#niu2-right-container");var c=$("#niu2-toolbar-showsidebar").data("title");var e=$("#niu2-toolbar-ctrlsidebar").attr("title");var d=$("#niu2-toolbar-github").data("repo").replace(/\/+$/g,"");if(""!=d){var a=window.location.pathname.replace(/html$/,"md");if(-1==a.replace(/^\//,"").search("/")){a="/pages"+a}$("#niu2-toolbar-revhistory").attr("href","https://github.com/"+d+"/commits/master/content"+a);$("#niu2-toolbar-viewsource").attr("href","https://raw.githubusercontent.com/"+d+"/master/content"+a)}$("#niu2-toolbar-ctrlsidebar").click(function(f){f.preventDefault();if(!b.is(":hidden")){b.hide();$("#niu2-left-container").attr("class","col-md-8 col-md-offset-2");$("#body-footer").attr("class","col-md-8 col-md-offset-2");$("#niu2-toolbar-ctrlsidebar i").attr("class","fa fa-3x fa-arrow-circle-left");$("#niu2-toolbar-ctrlsidebar").attr("title",c)}else{b.show();$("#niu2-left-container").attr("class","col-md-6 col-md-offset-2 with-right-border");$("#body-footer").attr("class","col-md-6 col-md-offset-2");$("#niu2-toolbar-ctrlsidebar i").attr("class","fa fa-3x fa-arrow-circle-right");$("#niu2-toolbar-ctrlsidebar").attr("title",e);locateTocInViewport()}resetFootnoteRefs();resetFootnoteBackRefs();resetFootnoteRefMap()})}}function initLazyLoad(){if($("#niu2-lazy-load")[0]){var c=$("#body-content img.lazy");var b=getMainContent().getBoundingClientRect().width;var a=$("#niu2-lazy-load-text").data("loading");c.each(function(e,g){var h=parseInt($(g).data("width"));var d=parseInt($(g).data("height"));var j=(h>b)?(b/h*d):d;$(g).attr("height",j+"px");$(g).parent().addClass("image-cover-box");var f=$('<span class="image-cover">'+a+'<i class="fa fa-spinner fa-spin"></i></span>').insertAfter($(g));f.css("top",((j-f.height())/2-3)+"px");f.css("width",(b>h?h:b)+"px")});c.lazyload({threshold:100,effect:"fadeIn",load:function(){$(this).css("height","auto");$(this).attr("height","");$(this).parent().removeClass("image-cover-box");$(this).next(".image-cover").hide()}})}}function setSidebarTocSize(){getSidebarToc().attr("style","max-width:"+getSidebarToc().width()+"px;")}function toggleSidebarTocFixed(){var b=$("#niu2-sidebar-toc");var a=$("#niu2-sidebar-meta");var c=$(window).scrollTop();var d=a.offset().top+a.height()-55;if(!b.is(":hidden")&&c>d&&"niu2-sidebar"==b.attr("class")){b.attr("class","niu2-sidebar niu2-sidebar-toc-fixed")}else{if(c<=d&&"niu2-sidebar"!=b.attr("class")){b.attr("class","niu2-sidebar")}}}function showCSE(){if(!$("#niu2-cse-search-input").is(":visible")){$("#niu2-cse-search-input").val("");$("#niu2-cse-search-input").show(300,function(){$("#niu2-cse-search-input").focus()});$("#niu2-cse-search-image").hide(300)}}function hideCSE(){if($("#niu2-cse-search-input").is(":visible")){$("#niu2-cse-search-input").hide(300);$("#niu2-cse-search-image").show(300)}}function setTocOverflowedTitle(){getSidebarTocLinks().each(function(a,b){$(b).mouseenter(function(){var c=$(this);if(isOverflowed(this)&&!c.attr("title")){c.attr("title",c.text())}})})}function isOverflowed(a){if(a.scrollHeight>a.offsetHeight||a.scrollWidth>a.offsetWidth){return true}return false}function toggleTopIcon(){$(this).children(":first").toggleClass("niu2-top-icon-hidden")}function initGoogleCSEAnimation(){$("#niu2-cse-ctrl-box").click(showCSE);$("#niu2-cse-ctrl-box").focus(showCSE);$("#niu2-cse-search-input").hide();$("#niu2-cse-search-input").focusout(hideCSE);$(document).keyup(function(a){a=a||window.event;if(a.keyCode==27){hideCSE()}})}function getToolbar(){if(!window.gToolbar){window.gToolbar=$("#niu2-toolbar")[0]}return window.gToolbar}function getMainContent(){if(!window.gMainContent){window.gMainContent=$("#niu2-main-content")[0]}return window.gMainContent}function getHtmlHeaders(){if(!window.gHtmlHeaders){window.gHtmlHeaders=$(":header");if(getFootnoteRefs().length>0){window.gHtmlHeaders.push($("#content-references")[0])}var a=$("#content-comments")[0];if(a){window.gHtmlHeaders.push(a)}}return window.gHtmlHeaders}function locateTocInViewport(){if(!window.gEnableTocStatusUpdate){return}var a=getHtmlHeaders();var d;for(var b=0;b<a.length;b++){var c=a[b];if(c.getBoundingClientRect().top>=window.gFixedHeaderHeight){if(b>0){c=a[b-1]}d=c.id;break}}if(!d){d=a.last().attr("id")}resetTocListHeight();updateTocLinkStatus(d);autoscrollTocList()}function getSidebarTocLinks(){if(!window.gSidebarTocLinks){window.gSidebarTocLinks=$("#niu2-sidebar-toc-list a")}return window.gSidebarTocLinks}function getSidebarToc(){if(!window.gSidebarToc){window.gSidebarToc=$("#niu2-sidebar-toc")}return window.gSidebarToc}function getTocList(){if(!window.gTocList){window.gTocList=$("#niu2-sidebar-toc-list")}return window.gTocList}function initTocListIndex(b,a){if(a&&""!=a){a+="."}else{a=""}b.children().each(function(g,h){var c=$(h);var d=a+(g+1);c.prepend('<span class="niu2-sidebar-toc-index">'+d+".</span>");var f=c.children();if(2<f.length){initTocListIndex($(f[2]),d)}})}function updateTocLinkStatus(a){if(isAllTocsClosed()){closeAllTocs()}getSidebarTocLinks().each(function(b,d){var c=$(d);if(a==c.attr("href").substr(c.attr("href").indexOf("#")+1)){c.attr("class",window.gActiveTocClass);if(isAllTocsClosed()){openActiveTocList(c.parent())}}else{if(""!=c.attr("class")){c.attr("class","")}}})}function resetTocListHeight(){var a=$(window).height()-window.gFixedTocListOffsetTop+20;if(getTocList().height()>=a){getTocList().attr("style","height: "+a+"px;")}else{getTocList().attr("style","")}}function autoscrollTocList(){if(!window.gEnableTocListAutoScroll||window.gMouseInSidebarTocList){return}var d=$(".niu2-active-toc").first();var e=d[0].getBoundingClientRect();var b=getTocList()[0].getBoundingClientRect();var c=e.top-(b.top+b.bottom)/2;var a=(c>0)?1:-1;c+=a*b.height/5;if(e.top<b.top+15||e.bottom>b.bottom-15){window.gEnableTocListAutoScroll=false;getTocList().animate({scrollTop:getTocList().scrollTop()+c},400,function(){window.gEnableTocListAutoScroll=true})}}function openActiveTocList(a){var b=a.children();if(b.length>2&&$(b[2]).is("ol")){showToc($(b[2]));showToc($(b[2]).children())}showToc(a);showToc(a.siblings());a.parents().each(function(c,d){if("niu2-sidebar-toc-list"==d.id){return false}showToc($(d));if($(d).is("li")){showToc($(d).siblings())}})}function closeAllTocs(){hideToc($("#niu2-sidebar-toc-list ol li"));hideToc($("#niu2-sidebar-toc-list li ol"))}function openAllTocs(){showToc($("#niu2-sidebar-toc-list ol li"));showToc($("#niu2-sidebar-toc-list li ol"))}function initTocLinkScrollAnimation(){initScrollAnimation(getSidebarTocLinks(),function(a){return a.offset().top},400,function(){updateFootnoteStatus();window.gEnableTocStatusUpdate=true;locateTocInViewport()})}function initFootnote(){if(getFootnoteRefs().length>0){var a="脚注";getTocList().children(":last").before('<li><a href="#content-references">'+a+"</a></li>");$(".footnote").before('<h2 id="content-references">'+a+"</h2>")}initFootnoteBackRefLinks();initFootnoteBackRefAnimation();initMouseXYRecord();initFootnoteRefPopover();initFootnoteRefAnimation()}function updateFootnoteStatus(){unhighlightFootnote();highlightFootnote()}function highlightElement(a){a.addClass("alert-success")}function unhighlightElement(a){a.removeClass("alert-success")}function highlightSubBackref(a){a.addClass("activeSubBackref")}function unhighlightSubBackref(a){a.removeClass("activeSubBackref")}function getFootnoteHlIndex(){return 1}function highlightFtSubBackrefs(a){if(null!=window.gCurrFootnoteRefPos){var b=$(a.children(".backref-span").children(".sub-backref-link").children()[window.gCurrFootnoteRefPos]);if(b[0]){highlightSubBackref(b);window.gHlFootnoteSubBackref=b}}}function highlightFootnote(){var a=window.location.hash.substring(1);if(null!=window.gCurrFootnoteHlPos){var b=$(getFootnoteRefs().parent().filter('[id="'+a+'"]'));if(b.length>window.gCurrFootnoteHlPos){window.gHlFootnoteRef=$(b[window.gCurrFootnoteHlPos]);highlightElement(window.gHlFootnoteRef);return}}getFootnoteLis().each(function(c,f){var d=$(f);if(d.attr("id")==a){highlightElement($(d));highlightFtSubBackrefs(d);window.gHlFootnote=d;return false}})}function unhighlightFootnote(){if(window.gHlFootnoteRef){if("#"+window.gHlFootnoteRef.attr("id")==window.location.hash){return false}unhighlightElement(window.gHlFootnoteRef);window.gHlFootnoteRef=null;return}if(window.gHlFootnote){if("#"+window.gHlFootnote.attr("id")==window.location.hash){return false}var a=$(window.gHlFootnote);if(""!=a.attr("class")){unhighlightElement(a);window.gHlFootnote=null}}if(window.gHlFootnoteSubBackref){unhighlightSubBackref(window.gHlFootnoteSubBackref);return}}function resetFootnoteRefs(){window.gFootnoteRefs=$(".footnote-ref")}function getFootnoteRefs(){if(!window.gFootnoteRefs){resetFootnoteRefs()}return window.gFootnoteRefs}function resetFootnoteRefMap(){window.gFootnoteIdMap={};getFootnoteRefs().each(function(c,f){var b=$(f);var d=b.parent();var a=b.attr("href").substring(1);if(!window.gFootnoteIdMap[a]){window.gFootnoteIdMap[a]={};window.gFootnoteIdMap[a].id=d.attr("id");window.gFootnoteIdMap[a].offsets=[]}window.gFootnoteIdMap[a].offsets.push(d.offset())})}function getFootnoteRefMap(a){if(!window.gFootnoteIdMap){resetFootnoteRefMap()}return window.gFootnoteIdMap[a]}function resetFootnoteBackRefs(){window.gFootnoteBackRefs=$(".footnote-backref")}function getFootnoteBackRefs(){if(!window.gFootnoteBackRefs){resetFootnoteBackRefs()}return window.gFootnoteBackRefs}function getFootnoteLis(){if(!window.gFootnoteList){window.gFootnoteList=$(".footnote li")}return window.gFootnoteList}function initFootnoteBackRefLinks(){getFootnoteLis().each(function(d,h){var a=$(h);var f=a.attr("id");var g=getFootnoteRefMap(a.attr("id"));var c=g.offsets.length;var b='<span class="backref-span">';if(1==(c)){b+='<a class="footnote-backref" href="#'+g.id+'" data-source="'+f+'"><i class="fa fa-angle-up"></i></a>'}else{b+='<i class="fa fa-angle-up"></i><span class="sub-backref-link">';for(var d=0;d<c;d++){b+='<a class="footnote-backref" href="#'+g.id+'" data-source="'+f+'">'+(d+1)+"</a> "}b+="</span>"}b+="</span>";a.prepend(b)})}function initFootnoteBackRefAnimation(){initScrollAnimation(getFootnoteBackRefs(),function(c,b){var a=getFootnoteRefMap(b.attr("data-source"));if(1==a.offsets.length){return a.offsets[0].top-window.gFixedHeaderHeight}else{return a.offsets[parseInt(b.text())-1].top-window.gFixedHeaderHeight}},400,function(a){if(""!=a.text()){window.gCurrFootnoteHlPos=parseInt(a.text())-1}else{window.gCurrFootnoteHlPos=0}updateFootnoteStatus();window.gEnableTocStatusUpdate=true;locateTocInViewport()})}function initFootnoteRefAnimation(){initScrollAnimation(getFootnoteRefs(),function(a){return a.offset().top-100-window.gFixedHeaderHeight},400,function(b){var a=getFootnoteRefs().parent().filter('[id="'+b.parent().attr("id")+'"]');a.each(function(c,d){if(b[0]==$(d).children()[0]){window.gCurrFootnoteRefPos=c;return false}});updateFootnoteStatus();window.gEnableTocStatusUpdate=true;locateTocInViewport()})}function initFootnoteRefPopover(){getFootnoteRefs().each(function(b,f){var d=$(f);var a=$(document.getElementById(d.attr("href").substring(1)));var c=$(a.children()[getFootnoteHlIndex()]);d.popover({trigger:"hover",placement:"auto top",html:true,container:"body",content:c.html()});d.on("hide.bs.popover",function(){if(window.gFootnotePopoverLink){return false}return true});d.mouseleave(function(){});d.mouseenter(function(){var i=$(this);if(window.gFootnotePopoverLink&&window.gFootnotePopoverLink[0]!=i[0]){hideFootnotePopover()}var g=$(".popover")[0];if(g){window.gEnableMouseXYRecord=true;window.gFootnotePopoverLink=i;var h=g.getBoundingClientRect();var e=f.getBoundingClientRect();window.gPopoverXY={};window.gPopoverXY.top=h.top<e.top?h.top:e.bottom;window.gPopoverXY.bottom=h.top<e.top?e.top:h.bottom;window.gPopoverXY.left=h.left<e.left?h.left:e.left;window.gPopoverXY.right=h.right<e.right?e.right:h.right;window.gRefLinkXY={};window.gRefLinkXY.top=e.top;window.gRefLinkXY.bottom=e.bottom;window.gRefLinkXY.left=e.left-10;window.gRefLinkXY.right=e.right+10}})})}function hideFootnotePopover(){var a=window.gFootnotePopoverLink;window.gFootnotePopoverLink=null;window.gEnableFootnotePopover=false;a.popover("hide")}function isPositionInRect(a,c,b){if(a>=b.left&&a<=b.right&&c>=b.top&&c<=b.bottom){return true}return false}function initMouseXYRecord(){$(document).mousemove(function(a){if(window.gEnableMouseXYRecord&&window.gPopoverXY&&window.gRefLinkXY){if(!isPositionInRect(a.clientX,a.clientY,window.gPopoverXY)&&!isPositionInRect(a.clientX,a.clientY,window.gRefLinkXY)){window.gEnableMouseXYRecord=false;hideFootnotePopover()}}if(isPositionInRect(a.clientX,a.clientY,getTocList()[0].getBoundingClientRect())){window.gMouseInSidebarTocList=true}else{window.gMouseInSidebarTocList=false}var b=getMainContent().getBoundingClientRect();if(getToolbar()&&a.clientY>b.bottom-b.height){if(window.gToolbarHidden&&a.clientX<b.left){$(getToolbar()).animate({left:"0px"},500);window.gToolbarHidden=false}else{if(!window.gToolbarHidden&&a.clientX>b.left){$(getToolbar()).animate({left:"-36px"},500);window.gToolbarHidden=true}}}})}function initScrollAnimation(a,c,b,d){a.each(function(f,g){$(g).click(function(h){h.preventDefault();var e=$(g).attr("href").substring($(g).attr("href").indexOf("#")+1);if(window.location.hash!=e&&window.history.pushState){window.history.pushState("toc change",e,"#"+e)}window.gEnableTocStatusUpdate=false;target=$(document.getElementById(e));source=$(this);$("body, html").animate({scrollTop:c(target,source)},b,function(){d(source)})})})}function showToc(a){a.each(function(b,c){var d=$(c);if(d.is("li")){d.attr("style","display:list-item;")}else{if(d.is("ol")){d.attr("style","display:block;")}}})}function hideToc(a){a.each(function(b,c){$(c).attr("style","display:none;")})}function initAllTocsCtrl(){if(isAllTocsClosed()){closeAllTocs()}else{openAllTocs()}getSidebarTocCtrl().click(function(){toggleAllTocs()})}function toggleAllTocs(){if(isAllTocsClosed()){getSidebarToc().data("status","open");getSidebarTocCtrl().attr("class","fa fa-minus");openAllTocs()}else{getSidebarToc().data("status","closed");getSidebarTocCtrl().attr("class","fa fa-plus");closeAllTocs()}locateTocInViewport()}function isAllTocsClosed(){if("closed"==getSidebarToc().data("status")){return true}return false}function getSidebarTocCtrl(){if(!window.gSidebarTocCtrl){window.gSidebarTocCtrl=$("#niu2-sidebar-toc-ctrl")}return window.gSidebarTocCtrl};