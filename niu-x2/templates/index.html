{% extends "base.html" %}

{% block content %}

<div class="niu2-page">

{% block content_header %}

<h1 class="niu2-index-title">
{{ SITENAME }}
</h1>

{% endblock content_header %}

{% block content_body %}

{% if articles %}
	{% for article in (articles_page.object_list if articles_page else articles) %}
	   <div class="niu2-index-date pull-right">
		  <i class="icon-calendar"></i>
		  <span>{{ article.date.strftime('%Y-%m-%d') }}</span>    
	   </div>
	   <div class="niu2-index-article">
           <span>
               {% if NIUX2_CATEGORY_MAP and NIUX2_CATEGORY_MAP[article.category] %}
                   {% set my_cat = NIUX2_CATEGORY_MAP[article.category][0] %}
                   {% set my_cat_icon = NIUX2_CATEGORY_MAP[article.category][1] %}
               {% else %}
                   {% set my_cat = article.category %}
                   {% set my_cat_icon = "icon-folder-open" %}
               {% endif %}
              <i class="{{ my_cat_icon }}"></i>
              <a href="{{ SITEURL }}/{{ article.url }}">{{ article.html_h1 | default(article.title) }}</a>
           </span>
       </div>
	{% endfor %}
{%endif%}

{% endblock content_body %}
</div>

{% block pager %}

{# 
  N: pagination length
  n: number of pages
  x: current page number
  pager bar style:
  1 2 ... x-N/2+3 ~ x+N/2-4 ... n-1 n-2
  compare x-N/2-3 == 3 and x+N/2-4 == n-1
#}

{% if articles_page and articles_paginator.num_pages > 1 %}

<ul class="pagination">
	{% if articles_page.has_previous() %}
	   {% set num = articles_page.previous_page_number() %}
	   <li><a href="{{ SITEURL }}/{{ page_name }}{{ num if num > 1 else '' }}.html">
	       <i class="icon-caret-left icon-large"></i></a>
	   </li>
	{% else %}
	   <li class="disabled"><a href="#">
	       <i class="icon-caret-left icon-large"></i></a>
	   </li>
	{% endif %}
	{% set page_limit = NIUX2_PAGINATOR_LENGTH | default(11) %}
	{% if articles_paginator.num_pages > page_limit %}
	   {% set divide_lost = 0 %}
	   {% if page_limit % 2 != 0 %}
	       {% set divide_lost = 1 %}
	   {% endif %}
	   <li class="{{ 'active' if 1 == articles_page.number else '' }}">
           <a href="{{ SITEURL }}/{{ page_name }}.html">1</a>
       </li>
       <li class="{{ 'active' if 2 == articles_page.number else '' }}">
           <a href="{{ SITEURL }}/{{ page_name }}2.html">2</a>
       </li>
	   {% if articles_page.number <= page_limit // 2 %}
	       {% for num in range(3, page_limit - 2) %}
       <li class="{{ 'active' if num == articles_page.number else '' }}">
           <a href="{{ SITEURL }}/{{ page_name }}{{ num if num > 1 else '' }}.html">{{ num }}</a>
       </li>
           {% endfor %}
       <li class="disabled"><a href="#">...</a></li>
       {% elif articles_page.number >= articles_paginator.num_pages + 2 - page_limit // 2 - divide_lost %}
       <li class="disabled"><a href="#">...</a></li>
           {% for num in range(articles_paginator.num_pages - page_limit + 4, articles_paginator.num_pages - 1) %}
       <li class="{{ 'active' if num == articles_page.number else '' }}">
           <a href="{{ SITEURL }}/{{ page_name }}{{ num if num > 1 else '' }}.html">{{ num }}</a>
       </li>
           {% endfor %}
       {% else %}
       <li class="disabled"><a href="#">...</a></li>
           {% for num in range(articles_page.number - page_limit // 2 + 3, articles_page.number + page_limit // 2 - 3 + divide_lost) %}
       <li class="{{ 'active' if num == articles_page.number else '' }}">
           <a href="{{ SITEURL }}/{{ page_name }}{{ num if num > 1 else '' }}.html">{{ num }}</a>
       </li>
           {% endfor %}
       <li class="disabled"><a href="#">...</a></li>
       {% endif %}
       {% for num in range(articles_paginator.num_pages - 1, articles_paginator.num_pages + 1) %}
       <li class="{{ 'active' if num == articles_page.number else '' }}">
           <a href="{{ SITEURL }}/{{ page_name }}{{ num if num > 1 else '' }}.html">{{ num }}</a>
       </li>
       {% endfor %}
	{% else %}
		{% for num in range(1, 1 + articles_paginator.num_pages) %}
		   <li class="{{ 'active' if num == articles_page.number else '' }}">
		       <a href="{{ SITEURL }}/{{ page_name }}{{ num if num > 1 else '' }}.html">{{ num }}</a>
		   </li>
		{% endfor %}
	{% endif %}
	{% if articles_page.has_next() %}
	   <li><a href="{{ SITEURL }}/{{ page_name }}{{ articles_page.next_page_number() }}.html">
	       <i class="icon-caret-right icon-large"></i></a>
	   </li>
	{% else %}
	   <li class="disabled"><a href="#"><i class="icon-caret-right icon-large"></i></a></li>
	{% endif %}
</ul>
{% endif %}

{% endblock pager %}

{% endblock content %}
